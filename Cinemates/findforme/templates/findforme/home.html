{% extends 'findforme/base.html' %}

{% block title %}
Cinemates
{% endblock %}

{% block links %}
{% endblock %}

{% block body %}
<div class ="container" style="margin-top: 200px;">
    <h1 class="text-center">Randomize your perfect film</h1>
    
    <form method="POST" class="d-flex flex-wrap justify-content-around" id="searchform">
      {% csrf_token %}
      {{ form_key.as_p }}
      <select name="Categories" id="categories" class="d-flex justify-content-around" required>
        <option value="Comedy">Comedy</option>
        <option value="Sci-fi">Sci-fi</option>
        <option value="Horror">Horror</option>
        <option value="Romance">Romance</option>
        <option value="Action">Action</option>
        <option value="Thiller">Thriller</option>
        <option value="Drama">Drama</option>
        <option value="Mystery">Mystery</option>
        <option value="Crime">Crime</option>
        <option value="Animation">Animation</option>
        <option value="Adventure">Adventure</option>
        <option value="Fantasy">Fantasy</option>
        <option value="Superhero">Superhero</option>
      </select>

      <select required>
        <option value="9">>9</option>
        <option value="8">>8</option>
        <option value="7">>7</option>
        <option value="6">>6</option>
        <option value="5">>5</option>
        <option value="4">>4</option>
        <option value="3">>3</option>
        <option value="2">>2</option>
        <option value="1">>1</option>
      </select>

      <select name="Number" id="number" class="d-flex justify-content-around" required>
        <option value=1>1</option>
        <option value=2>2</option>
        <option value=3>3</option>
        <option value=4>4</option>
        <option value=5>5</option>
        
      </select>
      <button id="searchbutton" onclick ="SearchFilm()" class="btn btn-primary col-xs-6" type="button">Search</button>
    </form>
    
  </div>
  <div class="d-flex-center text-center mt-5">
        <div class="d-flex flex-wrap justify-content-around" id="FilmList">
          {% for film,film_link in films %}
              <a href="/film/{{film_link}}">
                  <div class="card text-white bg-primary mb-3 mx-5" style="width: 20rem;">
                      <div class="card-body">
                        <h4 class="card-title">{{film}}</h4>
                        <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
                      </div>
                  </div>
              </a>
          {% endfor %}
        </div>
  </div>
</div>
<div class="modal"><!-- Place at bottom of page --></div>

<script>
  $('#searchform').keypress(function (e) {                                       
       if (e.which == 13) {
            e.preventDefault();
            SearchFilm()   
       }
  });

  function SearchFilm(){
    $.ajax({
      type:'POST',
      url:"search/",
      dataType: "html",
      async: true,
      data:{
        category: $("#categories").val(),
        number : $("#number").val(),
        csrfmiddlewaretoken: $('input[name=csrfmiddlewaretoken]').val()
      },
      success: function (data) {
        $('#FilmList').replaceWith(data);
      }
    })
  }
  
  $body = $("body");

  $(document).on({
    ajaxStart: function() { $body.addClass("loading");    },
    ajaxStop: function() { $body.removeClass("loading"); }    
  });

</script>


{% endblock %}


